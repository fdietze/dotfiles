""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" using plugin manager vim-plug.
" auto-install if not found
if empty(glob('~/.vim/autoload/plug.vim'))
  silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
    \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  autocmd VimEnter * PlugInstall | source $MYVIMRC
endif

call plug#begin('~/.vim/plugged')
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" non-intrusive plugins which work without configuration
Plug 'tpope/vim-sensible'     " defaults everyone can agree on
Plug 'tpope/vim-repeat'       " enable dot-command for Plugins
Plug 'benjifisher/matchit.zip'     " matches not only parantheses, but also HTML-Tags and more
Plug 'Valloric/YouCompleteMe', { 'do': './install.py' } " fuzzy autocompletion
" https://github.com/rdnetto/YCM-Generator
Plug 'kopischke/vim-fetch' " open files at line with filename:32
Plug 'airblade/vim-rooter' " cd to project root
Plug 'airblade/vim-gitgutter' " VCS change info per line (only git)
Plug 'zirrostig/vim-smart-swap' " handle vim swap files, delete older and identical swap files



""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" helpful tools providing new bindings
Plug 'tpope/vim-commentary' " commenting
Plug 'terryma/vim-multiple-cursors' " sublime-like multiple cursors
Plug 'tpope/vim-surround' " surround text with quotes, parantheses, ...
Plug 'tpope/vim-speeddating' " ctrl+A/X on dates and time
Plug 'AndrewRadev/switch.vim' " toggle true/false etc
" Plug 'vim-scripts/ingo-library' | Plug 'vim-scripts/QuickFixCurrentNumber' " next quickfix location from current cursor position




""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" text objects
Plug 'kana/vim-textobj-user' " framework for custom text objects
Plug 'kana/vim-textobj-indent'         " i
Plug 'whatyouhide/vim-textobj-xmlattr' " x
Plug 'glts/vim-textobj-comment'        " c
Plug 'kana/vim-textobj-function'       " f
Plug 'kana/vim-textobj-entire'         " e
Plug 'PeterRincker/vim-argumentative'  " text object ',' / also provides argument movements with >, ],




""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" helpful tools providing functions and commands
" which need to be called/activated/mapped explicitly
Plug 'tpope/vim-fugitive' " git support
Plug 'junegunn/vim-easy-align'
Plug 'tpope/vim-eunuch' " unix commands
Plug 'junegunn/goyo.vim' " distraction-free writing
Plug 'terryma/vim-smooth-scroll' " redraw some intermediate steps when using PageUp/Down
" Plug 'luochen1990/rainbow' " color parantheses depending on their depth
" Plug 'fidian/hexmode' " HEX-Editor in vim
Plug 'Chiel92/vim-autoformat' " reformat source code
Plug 'vim-scripts/BufOnly.vim' " close all buffers except current one
Plug 'mbbill/undotree', {'on': ['UndotreeShow', 'UndotreeToggle']} " show undo tree
Plug 'junegunn/fzf.vim' " fuzzy selector
Plug 'junegunn/fzf' " fuzzy selector
Plug 'zirrostig/vim-schlepp' " Move selections / lines




""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" file type plugins
" Plug 'sheerun/vim-polyglot' " Lots of filetypes
Plug 'xolox/vim-easytags', {'on': 'Tags'} | Plug 'xolox/vim-misc', {'on': 'Tags'}
Plug 'derekwyatt/vim-scala', {'for': 'scala'} " Scala programming language
Plug 'othree/html5.vim', {'for': 'html'} " HTML
Plug 'Valloric/MatchTagAlways', {'for': 'html'} " Highlight matching/surrounding html tags
Plug 'othree/yajs.vim', {'for': 'javascript'} " New JavaScript Standard Ecmascript 6
Plug 'othree/javascript-libraries-syntax.vim', {'for': 'javascript'}
Plug 'neo4j-contrib/cypher-vim-syntax', {'for' : 'cypher'} " Neo4j Cypher query language
" Plug 'vim-scripts/JavaDecompiler.vim' " decompile java .class files on the fly
Plug 'rust-lang/rust.vim', {'for': 'rust'} " Rust programming language by Mozilla
Plug 'zah/nim.vim', {'for': 'nim'}
Plug 'cespare/vim-toml', {'for': 'toml'} " TOML (used for Rust project configuration)
Plug 'LaTeX-Box-Team/LaTeX-Box', {'for': 'tex'} " LaTeX
Plug 'vim-scripts/gnuplot.vim', {'for': 'gnuplot'}
Plug 'shmup/vim-sql-syntax'
Plug 'LnL7/vim-nix' " nixos syntax
Plug 'rhysd/vim-gfm-syntax' " Github flavoured markdown with embedded language support
Plug 'chrisbra/Colorizer' " color hex codes and color-names



""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" statusline
Plug 'itchyny/lightline.vim'
" Plug 'taohex/lightline-buffer'
Plug 'mgee/lightline-bufferline'



""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" colorschemes
Plug 'morhetz/gruvbox'
Plug 'fdietze/goodday.vim'


""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" experimental
" Plug 'scrooloose/syntastic'
Plug 'vim-scripts/LanguageTool' " spell grammar checking
" Plug 'Raimondi/delimitMate' " automatically-close-brackets-magic
" Plug 'vim-scripts/ColorSchemeEditor' " graphical editor for colorschemes
" Plug 'gerw/vim-HiLinkTrace' " identify highlighting group under cursor, useful when creating colorschemes
Plug 'jamessan/vim-gnupg'

" Collaborative Editing
" Plug 'FredKSchott/CoVim'
" Plug 'emgram769/vim-multiuser'
" TODO: , {'do': :UpdateRemotePlugins}
" Plug 'floobits/floobits-neovim' " https://floobits.com/help/plugins/nvim

" TODO: Plug 'nathanaelkane/vim-indent-guides'
" TODO: Plug 'ervandew/supertab'




call plug#end()


""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" plugin configuration

let g:scala_scaladoc_indent = 1 " enable indentation standard as recommended for Scaladoc comments (from http://docs.scala-lang.org/style/scaladoc.html, since Scaladoc2)

let g:colorizer_auto_filetype='css,html,dosini'

" fzf
let g:fzf_layout = {} " default to full screen

function! s:find_git_root()
  return system('git rev-parse --show-toplevel 2> /dev/null')[:-2]
endfunction

command! ProjectFiles execute 'Files' s:find_git_root()

" easytags
let g:easytags_cmd = "/usr/bin/ctags"
let g:easytags_auto_update = 1
let g:easytags_dynamic_files = 1
let g:easytags_by_filetype = "~/.vim/vimtags/"
let g:easytags_async = 1
let g:easytags_ignored_filetypes = ''
let g:easytags_updatetime_min = 30000
let g:easytags_languages = {
            \   'zsh': {
            \     'cmd': g:easytags_cmd,
            \       'args': ['--fields=+l', '--c-kinds=+p', '--c++-kinds=+p'],
            \       'fileoutput_opt': '-f',
            \       'stdout_opt': '-f-',
            \       'recurse_flag': '-R'
            \   }
            \}

" multiple-cursors
let g:multi_cursor_exit_from_visual_mode = 0
let g:multi_cursor_exit_from_insert_mode = 0

" YouCompleteMe
let g:ycm_server_python_interpreter = '/usr/bin/python3' " force ycm to use py3 - useful when multiple versions are installed
let g:ycm_auto_trigger = 1
let g:ycm_min_num_of_chars_for_completion = 3
let g:ycm_key_list_previous_completion = ['<S-TAB>']
let g:ycm_key_list_select_completion = ['<TAB>']
let g:ycm_cache_omnifunc = 0
let g:ycm_rust_src_path = '/home/felix/projects/rust/src'
let g:ycm_cpp_flags = ['-Wextra', '-Werror' ]
let g:ycm_extra_conf_vim_data = [ 'g:ycm_cpp_flags' ]
let g:ycm_global_ycm_extra_conf = '~/.vim/global_ycm_extra_conf.py'

" Goyo distraction free editing
let g:goyo_width = 80
let g:goyo_height = '100%'
let g:goyo_margin_top = 3
let g:goyo_margin_bottom = 3

" commentary
autocmd FileType sql setlocal commentstring=--\ %s
autocmd FileType cypher setlocal commentstring=//\ %s

" gitgutter and signify
let g:gitgutter_map_keys = 0 " no default mappings
let g:gitgutter_sign_added = '+'
let g:gitgutter_sign_modified = '⌇'
let g:gitgutter_sign_removed = '✕'
let g:gitgutter_sign_removed_first_line = '⌅'
let g:gitgutter_sign_modified_removed = '⌇✕'

" Languagetool
let g:languagetool_jar=$HOME."/local/languagetool/languagetool-commandline.jar"

" Github flavoured markdown
let g:markdown_fenced_languages = ['scala', 'javascript', 'json', 'bash=sh']

" Autoformat
let g:autoformat_autoindent = 0
let g:autoformat_retab = 0
let g:autoformat_remove_trailing_spaces = 1

let g:formatdef_scalariform ='"ng-scalariform"'
let g:formatdef_scalafmt ='"ng-scalafmt --stdin"'
let g:formatters_scala = ['scalariform', 'scalafmt']

let g:formatdef_htmltidy ='"html-beautify -s 2"'
let g:formatdef_jsbeautify ='"js-beautify -s 2"'
let g:formatdef_jsonbeautify ='"underscore print --outfmt json"'
let g:formatters_html = ['htmltidy']
let g:formatters_javascript = ['jsbeautify']
let g:formatters_json = ['jsonbeautify']


" vim schlepp
let g:Schlepp#allowSquishingLines = 1
let g:Schlepp#allowSquishingBlocks = 1
let g:Schlepp#reindent = 1


" switch.vim
let g:switch_custom_definitions =
            \ [
            \   ['on', 'off'],
            \   ['==', '!='],
            \   ['_', '-'],
            \   [' < ', ' > '],
            \   ['<=', '>='],
            \   [' + ', ' - '],
            \   ['-=', '+='],
            \   ['and', 'or'],
            \   ['if', 'unless'],
            \   ['YES', 'NO'],
            \   ['yes', 'no'],
            \   ['first', 'last'],
            \   ['else', 'else if'],
            \   ['max', 'min'],
            \   ['px', '%', 'em'],
            \   ['left', 'right'],
            \   ['top', 'bottom'],
            \   ['margin', 'padding'],
            \   ['height', 'width'],
            \   ['absolute', 'relative'],
            \   ['horizontal', 'vertical'],
            \   ['show', 'hide'],
            \   ['visible', 'hidden'],
            \   ['add', 'remove'],
            \   ['up', 'down'],
            \   ['before', 'after'],
            \   ['slow', 'fast'],
            \   ['small', 'large'],
            \   ['even', 'odd'],
            \   ['inside', 'outside'],
            \   ['with', 'extends'],
            \   ['class', 'object', 'trait'],
            \   ['def', 'val'],
            \   {'"\([^"]*\)"': '''\1''', '''\([^'']*\)''': '"\1"'},
            \   {
            \     '\<\(\l\)\(\l\+\(\u\l\+\)\+\)\>': '\=toupper(submatch(1)) . submatch(2)',
            \     '\<\(\u\l\+\)\(\u\l\+\)\+\>': "\\=tolower(substitute(submatch(0), '\\(\\l\\)\\(\\u\\)', '\\1_\\2', 'g'))",
            \     '\<\(\l\+\)\(_\l\+\)\+\>': '\U\0',
            \     '\<\(\u\+\)\(_\u\+\)\+\>': "\\=tolower(substitute(submatch(0), '_', '-', 'g'))",
            \     '\<\(\l\+\)\(-\l\+\)\+\>': "\\=substitute(submatch(0), '-\\(\\l\\)', '\\u\\1', 'g')",
            \   }
            \ ]

" rooter
let g:rooter_manual_only = 1
let g:rooter_disable_map = 1

