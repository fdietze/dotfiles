#!/usr/bin/env zsh
set -e # stops on first failure

. /etc/os-release # load linux distribution information
case $NAME in
    NixOS )
        echo "upgrading system"
        echo "channels:"
        sudo nix-channel --list
        sudo nixos-rebuild boot --upgrade
        echo "updating user space"
        echo "channels:"
        nix-channel --list
        nix-channel --update
        nix-env --upgrade
        ;;
esac


echo "updating vim plugins..."
nvim +PlugUpgrade +PlugInstall +PlugUpdate +PlugClean! +qall
nvim -c 'CocUpdateSync|q'


echo "updating zgen plugins..."
source "${HOME}/.zgen/zgen.zsh" && zgen update

# echo "updating ruby gems..."
# gem update

echo "updating global npm packages"
yarn global upgrade
npm -g update

# echo "updating rust installation"
# multirust update

sync

# backup-home

exit 0
