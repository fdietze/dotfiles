# launch helpers
alias qrscan='LD_PRELOAD=/usr/lib/libv4l/v4l1compat.so zbarcam --raw /dev/video0'
alias photoshop='wine ~/.wine/drive_c/Program\ Files\ \(x86\)/Adobe/Photoshop\ 7.0/Photoshop.exe'
alias gparted='gksudo gparted'
alias skype='gksudo "systemctl start docker"; skype'
alias teamviewer='gksudo "systemctl start teamviewerd"; sleep 5; teamviewer'

alias signal='chromium --app-id=bikioccmkafdpakkkcpdbppfkghcmihk'

# fix highdpi for chromium
alias chromium='chromium --high-dpi-support=1 --force-device-scale-factor=1'
alias chromium-continuous-bin='chromium-continuous-bin --high-dpi-support=1 --force-device-scale-factor=1'

# unsorted / general
alias d='yadm'
alias dp='yadm --git-dir=$HOME/projects/dotfiles-private/.git'
alias tigd='GIT_DIR=$HOME/.yadm/repo.git GIT_WORK_TREE=$HOME tig'
alias tigdp='GIT_DIR=$HOME/projects/dotfiles-private/.git GIT_WORK_TREE=$HOME tig'
alias ssh='TERM=xterm-256color ssh'
sshforward() {
    REMOTEHOST=$1
    REMOTELOCALPORT=$2
    LOCALPORT=$3
    ssh -NL ${LOCALPORT}:localhost:${REMOTELOCALPORT} ${REMOTEHOST}
}
alias hc='herbstclient'
alias watch='watch -c -d COPE=1 ' # force cope colors, and leave one space to trigger alias expansion in command
alias w='watch '
alias on='ping -c 1 8.8.8.8 && ping -c 4 google.com'
alias hd='hexdump -C'
alias fucking='sudo'
alias speakerup='amixer -c 0 sset Speaker 100%'
alias defrag='sudo btrfs filesystem defragment -r -v -f -clzo'
alias iotop='sudo iotop'
alias keepass='secret-tool lookup keepass password | keepass $HOME/.keepass/passwords.kdbx --pw-stdin'
alias kp='keepass-dmenu --database ~/.keepass/passwords.kdbx --password "$(secret-tool lookup keepass password)" --fn "Droid Sans Mono-8" --nb "#FFFFFF" --nf "#000000" --sb "#00D7FF" --sf "#101010" > /dev/null'
alias vbmods='sudo modprobe -a vboxnetadp vboxnetflt vboxpci virtio_net vboxdrv' # load VirtualBox kernel modules
alias cups='sudo systemctl start cups-browsed.service'
alias kodi='AE_SINK=ALSA kodi'

# wifi with networkmanager
alias won='nmcli radio wifi on; wscan'
alias woff='nmcli radio wifi off'
alias wscan='nmcli dev wifi rescan > /dev/null 2>&1; true'
alias wlist='nmcli dev wifi list'
alias wcon='nmcli dev wifi connect'

# yaourt
alias y='yaourt'
alias yoghurt='yaourt'
alias ys='yaourt -S' # install
alias yss='yaourt -S --noconfirm' # install
alias yu='yaourt -Syy' # update
alias yr='yaourt -Rs' # remove package
alias yi='yaourt -Qi' # package info
alias yb='yaourt -Sb' # build package
alias yo='yaourt -Qo' # package for command
alias yl='yaourt -Ql' # list files for package
alias ye='yaourt -Qe --date' # list installed packages

# vim
# alias vim='nvim'
alias va='vim ~/.sh_aliases'
alias vv='vim ~/.vimrc'
alias vvp='vim ~/.vimrc_plugins'
alias vvc='vim ~/.vimrc_custom'
alias vvk='vim ~/.vimrc_keybindings'
alias vvs='vim ~/.vimrc_statusline'
alias vim="vim --servername vim-$$" # always start vim as server (for live colorscheme changing)
alias vimt='vim $(date +"%Y-%m-%d")'
v() { (cd-git-root; vim "$(fzf --query="$(echo $@ | tr ' ' '\ ' )")"); }
alias vr="vim +:FZFMru"

nvim_command() {
    # usage: nvim_command <socket> <command>
    # requires: https://github.com/jakm/msgpack-cli

    # https://github.com/msgpack-rpc/msgpack-rpc/blob/master/spec.md
    # msgpack-rpc is an array of [type, msgid, method, params]
    # encode and send it to nvims unix socket via netcat
    msgpack-cli encode <(echo "[0,0,\"vim_command\",[\"$2\"]]") | netcat -U $1
}

nvim_all_command() {
    # usage: nvim_all_command <command>
    for nvim in /tmp/nvim*/0; do
        nvim_command $nvim "$1"
    done
}

# file search
alias lo='locate -i'
alias f='ag -i -g'
alias ff="find . -iname"
alias ag='ag -S -f'
alias gg='grep -irn'
alias gr='grep -i'
alias vag="search-select-edit"
fo() { xdg-open "$(fzf)" > /dev/null 2>&1; }
lto() { xdg-open "$(ls -tr1 --group-directories-first | fzf --tac --no-sort)" > /dev/null 2>&1; } # least modified files
s() {
    # interactively select a line from stdin and execute command
    # example usage: find /var/log/Xorg* | s less
    # if no stdin is given, match on all files in current dir
    fzf | while read -r line; do $@ "$line"; done
}

# file listing/interaction
alias ls='ls --group-directories-first --color=auto -h'
alias lt='ls -ltr'
alias l='ls -l'
alias t='tree -C' # -C is for color=always
alias ta='tree -a'
alias df='df -h'
alias md='mkdir -p'
alias mdcd='mkdir-cd'
alias mvi='interactive-mv'
alias mcp='noglob zmv -C -W'
alias mln='noglob zmv -L -W'
alias mmv='noglob zmv -W'
o() { xdg-open $@ > /dev/null 2>&1; }

# change directories
alias cdd='cd ~/downloads'
alias cdp='cd ~/projects'
alias cd.='cd ~/projects/dotfiles'
alias cdt='cd-tmp'
alias cdg='cd-git-root'

# start X
alias sx='startx'
alias xkodi='/usr/bin/xinit /usr/bin/dbus-launch --exit-with-session /usr/bin/kodi-standalone -- :0 -nolisten tcp vt1'

# web services
# alias w=''
alias wa='urlappend https://www.wolframalpha.com/input/?i='
alias aw='urlappend https://wiki.archlinux.org/index.php?search='
alias gh='urlappend https://github.com/search?q='
urlappend() {
    echo $*
    URL=$1
    shift 1
    chromium "$URL$*"
}

# git
alias g='git'
alias gs='git status'
alias gu='git up'
alias gp='git push'
alias gl='git lg'
alias gsc='git-select-commit'
alias gd='git df --no-index'
alias onstage='git-onstage'

# dev
alias m='make'
alias mc='make clean'
alias scala='scala -Dscala.color -deprecation -unchecked -explaintypes -language:_'
alias jsb='underscore print --color --outfmt json' # beautify json, package: npm -g install underscore-cli
# alias nquery='neo4j-query'
# alias nclear='neo4j-clear'
# alias nall='neo4j-all'
alias cg='cargo'

cgw() {
    cargo $1
    cargo watch $1
}

sbt() { (
    # TODO, only if there is no build.sbt in current folder
    cd-git-root
    env sbt $@
    )
}

nstart() {
    hc use_index 7
    (sleep 1; hc use_previous) &
    termite -e "$HOME/downloads/neo4j-community-2.2.2/bin/neo4j console"
}

wust() {
    hc use_index 7
    (sleep 1; hc use_previous) &
    termite -e "bash -c \"cd ~/projects/wust && sbt compile run\"" &
    termite -e "bash -c \"cd ~/projects/wust && ./blumenkohl\"" &
    termite -e "$HOME/downloads/neo4j-community-2.2.2/bin/neo4j console"
}


# other
autocolors() {
    if [ $(sunwait poll 50.77N 6.08W) == "DAY" ]
    then ~/bin/light $@
    else ~/bin/dark $@
    fi
}

low() {
    # save energy
    xbacklight -set 10 -time 0
    keyboardbacklightoff
    nmcli radio wifi off
    sudo rfkill block all

    light

    killall owncloud
    systemctl --user stop btsync
    systemctl --user stop dropbox
    systemctl --user stop syncthing
}

high() {
    xbacklight -set 100

    systemctl --user start btsync
    systemctl --user start syncthing
}

stayawake() {
    # disable screensaver
    xset s noblank
    xset s off
    xset -dpms
}

movietime() {
    killall redshift
    # xrandr --output HDMI-1  --auto --primary --output VGA-1 --off --output eDP-1 --off
    xrandr --output HDMI1  --auto --primary --output VGA1 --off --output eDP1 --off
    herbstclient reload
    pacmd set-sink-mute 0 0 # unmute
    xsetroot -solid '#ffffff'
    killall redshift

    stayawake
}

reset-screen() {
    killall redshift
    # xrandr --output eDP-1  --auto --primary --output VGA-1 --off --output HDMI-1 --off
    xrandr --output eDP1  --auto --primary --output VGA1 --off --output HDMI1 --off
    herbstclient reload

    xset s blank
    xset s on
    xset +dpms

    sleep 3
    rm -f ~/.colors
    autocolors
}

# vim: ft=sh
